{'R_grad_norm': 0.027072532307356595, 'training_loss': 0.10068708226084709}
{'R_grad_norm': 0.027903339369222523, 'training_loss': 0.09611839335411787}
{'R_grad_norm': 0.028762923637405038, 'training_loss': 0.09188704151660204}
{'R_grad_norm': 0.029529491234570743, 'training_loss': 0.08780131943523883}
{'R_grad_norm': 0.030392704531550407, 'training_loss': 0.0846644576266408}
{'R_grad_norm': 0.03113975388929248, 'training_loss': 0.0816017910465598}
{'R_grad_norm': 0.03158718598075211, 'training_loss': 0.07906467795372009}
{'R_grad_norm': 0.031892388872802255, 'training_loss': 0.07698205895721913}
{'R_grad_norm': 0.03250029111281037, 'training_loss': 0.07531059410423041}
{'R_grad_norm': 0.0326062163989991, 'training_loss': 0.07331788524985314}
{'R_grad_norm': 0.03317174348980188, 'training_loss': 0.07207088842988014}
{'R_grad_norm': 0.03319580934941769, 'training_loss': 0.07059553451836109}
{'R_grad_norm': 0.033503396306186914, 'training_loss': 0.06931801050901414}
{'R_grad_norm': 0.0336811294965446, 'training_loss': 0.06817237574607134}
{'R_grad_norm': 0.03377041458152234, 'training_loss': 0.06758943585678935}
{'R_grad_norm': 0.034002344720065594, 'training_loss': 0.0666825084388256}
{'R_grad_norm': 0.03419017780572176, 'training_loss': 0.06610510611906648}
{'R_grad_norm': 0.03404153713956475, 'training_loss': 0.06538750743493438}
{'R_grad_norm': 0.03432875953614712, 'training_loss': 0.0645177755691111}
{'R_grad_norm': 0.0343178223259747, 'training_loss': 0.06395568611100316}
{'R_grad_norm': 0.03451648039743304, 'training_loss': 0.06343005403876305}
{'R_grad_norm': 0.034660245925188064, 'training_loss': 0.06276767859235406}
{'R_grad_norm': 0.034635584056377414, 'training_loss': 0.062189048565924165}
{'R_grad_norm': 0.03462482590228319, 'training_loss': 0.06149498894810677}
{'R_grad_norm': 0.03474833510816097, 'training_loss': 0.06136171603575349}
eval result tensor([0.0356, 0.0336, 0.0401, 0.0254, 0.0322, 0.0411, 0.0478, 0.0330],
       device='cuda:0')
computing merge metric
normed mi [((3, 4), 0.36308732628822327), ((1, 3), 0.3064470589160919), ((1, 4), 0.30241766571998596), ((0, 4), 0.2870558202266693), ((0, 3), 0.28265783190727234), ((2, 4), 0.2661256790161133), ((1, 7), 0.26175564527511597), ((4, 7), 0.25409528613090515), ((2, 3), 0.2540074288845062), ((0, 1), 0.253998726606369), ((3, 7), 0.2480003535747528), ((1, 2), 0.24003849923610687), ((2, 7), 0.23396103084087372), ((0, 2), 0.23298446834087372), ((5, 7), 0.22565194964408875), ((0, 7), 0.2189938873052597), ((4, 6), 0.21177969872951508), ((4, 5), 0.2098369002342224), ((1, 5), 0.2046653926372528), ((3, 6), 0.20339810848236084), ((3, 5), 0.1981254518032074), ((2, 5), 0.18804121017456055), ((0, 5), 0.18011675775051117), ((0, 6), 0.1761752814054489), ((6, 7), 0.16590532660484314), ((1, 6), 0.16436851024627686), ((2, 6), 0.15556365251541138), ((5, 6), 0.13721121847629547)]
******* after merging (0.04): [((3, 4), 16), ((0,), 8), ((1,), 8), ((2,), 8), ((5,), 8), ((6,), 8), ((7,), 8)]
{'R_grad_norm': 0.04001284843310714, 'training_loss': 0.06947646550834179}
{'R_grad_norm': 0.040154037568718194, 'training_loss': 0.06910064779222011}
{'R_grad_norm': 0.04047283114865422, 'training_loss': 0.06879504192620516}
{'R_grad_norm': 0.04078480578958988, 'training_loss': 0.06786523381248116}
{'R_grad_norm': 0.04067072872072458, 'training_loss': 0.06735510626807809}
{'R_grad_norm': 0.04058880651369691, 'training_loss': 0.06664659408852458}
{'R_grad_norm': 0.04068241730332375, 'training_loss': 0.06640851372852921}
{'R_grad_norm': 0.04074169268831611, 'training_loss': 0.06627146670594812}
{'R_grad_norm': 0.04092614250257611, 'training_loss': 0.0658499388769269}
{'R_grad_norm': 0.040894354060292244, 'training_loss': 0.06563226703554392}
{'R_grad_norm': 0.04113375559449196, 'training_loss': 0.06516182815656066}
{'R_grad_norm': 0.04109756886959076, 'training_loss': 0.06451036751270295}
{'R_grad_norm': 0.041078496035188435, 'training_loss': 0.06421092040836811}
{'R_grad_norm': 0.04106951367110014, 'training_loss': 0.0640449675358832}
{'R_grad_norm': 0.04102677769958973, 'training_loss': 0.06352924896404147}
{'R_grad_norm': 0.04115844504907727, 'training_loss': 0.06333360327407718}
eval result tensor([0.0583, 0.0306, 0.0313, 0.0363, 0.0380, 0.0423, 0.0289],
       device='cuda:0')
computing merge metric
normed mi [((2, 6), 0.23998181521892548), ((2, 3), 0.22073529660701752), ((3, 6), 0.21072682738304138), ((0, 2), 0.20364069938659668), ((1, 2), 0.2019130140542984), ((4, 6), 0.19782675802707672), ((1, 3), 0.19374379515647888), ((0, 6), 0.18618804216384888), ((0, 1), 0.18599613507588705), ((0, 3), 0.18517384926478067), ((2, 4), 0.1832655668258667), ((1, 6), 0.17783570289611816), ((3, 4), 0.17258237302303314), ((1, 5), 0.16022804379463196), ((3, 5), 0.15138868987560272), ((1, 4), 0.1489771455526352), ((0, 4), 0.1484746734301249), ((2, 5), 0.14548754692077637), ((0, 5), 0.1431448757648468), ((5, 6), 0.14149068295955658), ((4, 5), 0.12598609924316406)]
******* after merging (0.04): [((2, 6), 16), ((0,), 16), ((1,), 8), ((3,), 8), ((4,), 8), ((5,), 8)]
{'R_grad_norm': 0.044136919733136895, 'training_loss': 0.07555346380919219}
{'R_grad_norm': 0.04429505048319697, 'training_loss': 0.07496084943413735}
{'R_grad_norm': 0.04434991523623467, 'training_loss': 0.07487694032490254}
{'R_grad_norm': 0.044372277706861495, 'training_loss': 0.07436060816049576}
{'R_grad_norm': 0.044400503616780045, 'training_loss': 0.07368640393018723}
{'R_grad_norm': 0.04435049645602703, 'training_loss': 0.0733829864859581}
{'R_grad_norm': 0.04452380176633596, 'training_loss': 0.07311996679753065}
{'R_grad_norm': 0.04432422792539001, 'training_loss': 0.0731987689062953}
{'R_grad_norm': 0.04458279129117727, 'training_loss': 0.07267550066113472}
{'R_grad_norm': 0.044274357352405785, 'training_loss': 0.07249234091490507}
{'R_grad_norm': 0.04449606727808714, 'training_loss': 0.07219863582402468}
{'R_grad_norm': 0.044228585474193095, 'training_loss': 0.07203667592257261}
{'R_grad_norm': 0.04431925999000669, 'training_loss': 0.0714975967258215}
{'R_grad_norm': 0.044423812553286555, 'training_loss': 0.07182438895106316}
{'R_grad_norm': 0.04423248881474137, 'training_loss': 0.071574293859303}
{'R_grad_norm': 0.04437006862834096, 'training_loss': 0.0715532997250557}
eval result tensor([0.0691, 0.0562, 0.0294, 0.0346, 0.0378, 0.0407], device='cuda:0')
computing merge metric
normed mi [((2, 3), 0.1840345561504364), ((1, 2), 0.1771042744318644), ((1, 3), 0.17007529735565186), ((0, 1), 0.15936219692230225), ((3, 4), 0.15443982183933258), ((2, 5), 0.15413375198841095), ((2, 4), 0.15224915742874146), ((0, 4), 0.14862148960431418), ((0, 3), 0.14706743756930032), ((1, 4), 0.14119054873784384), ((0, 2), 0.14015581210454306), ((3, 5), 0.13880276679992676), ((1, 5), 0.13736789425214133), ((4, 5), 0.11395962536334991), ((0, 5), 0.08754052718480428)]
******* after merging (0.04): [((2, 3), 16), ((0,), 16), ((1,), 16), ((4,), 8), ((5,), 8)]
{'R_grad_norm': 0.04675525095313787, 'training_loss': 0.08997518744319677}
{'R_grad_norm': 0.046941647343337535, 'training_loss': 0.0895117586478591}
{'R_grad_norm': 0.04694355327636004, 'training_loss': 0.08913239222019911}
{'R_grad_norm': 0.04689873192459345, 'training_loss': 0.08879066418856382}
{'R_grad_norm': 0.04676074005663395, 'training_loss': 0.08857025258243084}
{'R_grad_norm': 0.046813563425093886, 'training_loss': 0.08845963835716247}
{'R_grad_norm': 0.046780357770621776, 'training_loss': 0.08834799941629172}
{'R_grad_norm': 0.047151028513908386, 'training_loss': 0.08813916932791471}
{'R_grad_norm': 0.04699040196835995, 'training_loss': 0.08804984755814076}
{'R_grad_norm': 0.04704903753474355, 'training_loss': 0.08761541772633791}
{'R_grad_norm': 0.04685970762744546, 'training_loss': 0.08746864918619394}
{'R_grad_norm': 0.04695461735129356, 'training_loss': 0.08745761755853891}
{'R_grad_norm': 0.04686841245740652, 'training_loss': 0.08708289477974177}
{'R_grad_norm': 0.046977351699024436, 'training_loss': 0.08681509096175433}
{'R_grad_norm': 0.047034127023071054, 'training_loss': 0.08709976177662611}
{'R_grad_norm': 0.046910902801901105, 'training_loss': 0.08704738799482584}
eval result tensor([0.0803, 0.0671, 0.0566, 0.0368, 0.0388], device='cuda:0')
computing merge metric
normed mi [((1, 2), 0.15765637159347534), ((1, 3), 0.15075430274009705), ((0, 2), 0.14438124001026154), ((2, 3), 0.14160664876302084), ((2, 4), 0.13850005467732748), ((0, 1), 0.12448185682296753), ((0, 3), 0.12072476744651794), ((3, 4), 0.1146167516708374), ((0, 4), 0.09345508615175883), ((1, 4), 0.08774632215499878)]
******* after merging (0.04): [((1, 2), 32), ((0,), 16), ((3,), 8), ((4,), 8)]
{'R_grad_norm': 0.0535081322863698, 'training_loss': 0.10876516122370958}
{'R_grad_norm': 0.053329029083251954, 'training_loss': 0.10766418658196926}
{'R_grad_norm': 0.05333781866356731, 'training_loss': 0.10773551899939776}
{'R_grad_norm': 0.05352622171863913, 'training_loss': 0.10789268922060728}
{'R_grad_norm': 0.05358851602301001, 'training_loss': 0.10745623264461755}
{'R_grad_norm': 0.05337008945643902, 'training_loss': 0.10702445238828659}
{'R_grad_norm': 0.05360249875113368, 'training_loss': 0.10711753394454718}
{'R_grad_norm': 0.05350530182942748, 'training_loss': 0.10703840494155883}
{'R_grad_norm': 0.05364285783842206, 'training_loss': 0.10692203622311354}
{'R_grad_norm': 0.053364706374704834, 'training_loss': 0.10632711190730333}
{'R_grad_norm': 0.05333942769095302, 'training_loss': 0.1064452363178134}
{'R_grad_norm': 0.05353087652474642, 'training_loss': 0.10616409718990326}
{'R_grad_norm': 0.05342688720673323, 'training_loss': 0.10609325233846903}
{'R_grad_norm': 0.05343917336314916, 'training_loss': 0.10609550308436155}
{'R_grad_norm': 0.053342900034040214, 'training_loss': 0.10623667538166046}
{'R_grad_norm': 0.053609137833118437, 'training_loss': 0.10568055510520935}
eval result tensor([0.1249, 0.0762, 0.0370, 0.0362], device='cuda:0')
computing merge metric
normed mi [((1, 2), 0.11696829398473103), ((2, 3), 0.10957412421703339), ((0, 1), 0.09834437568982442), ((0, 2), 0.09442593455314637), ((1, 3), 0.0890612502892812), ((0, 3), 0.06293944120407105)]
******* after merging (0.04): [((0,), 32), ((1, 2), 24), ((3,), 8)]
{'R_grad_norm': 0.05370272921398282, 'training_loss': 0.14903678558766842}
{'R_grad_norm': 0.05366279128938913, 'training_loss': 0.14763570874929427}
{'R_grad_norm': 0.05467726496979594, 'training_loss': 0.14577237643301488}
{'R_grad_norm': 0.055170519053936, 'training_loss': 0.1450979857891798}
{'R_grad_norm': 0.054709118623286486, 'training_loss': 0.14402148351073266}
{'R_grad_norm': 0.05486754927784204, 'training_loss': 0.14389029666781425}
{'R_grad_norm': 0.05490800125524402, 'training_loss': 0.1439683286845684}
{'R_grad_norm': 0.054919146243482826, 'training_loss': 0.14292217105627059}
{'R_grad_norm': 0.05475679429247975, 'training_loss': 0.14341004461050033}
{'R_grad_norm': 0.05445700431242585, 'training_loss': 0.14306840769946574}
{'R_grad_norm': 0.05453059338033199, 'training_loss': 0.14330394938588142}
finish training (20000)
evaluating (25 steps)...
 ******* eval result *******
mean (weighted) 0.11393723636865616
mean (unweighted) 0.0958641991019249
tensor([0.1177, 0.1354, 0.0345], device='cuda:0')
